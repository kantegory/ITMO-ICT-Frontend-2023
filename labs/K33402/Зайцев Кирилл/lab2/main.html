<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Музыкальный плеер</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
    <style>
        /* Обновленные стили */
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            /* Замените URL на путь к вашему изображению */
            background-image: url('1645356429_9-phonoteka-org-p-temno-sinii-fon-anime-9.jpg');
            background-size: cover;
            background-position: center;
            color: #fff;
            position: relative;
        }

        /* Изменения для достижения достаточного контраста */
        .container-fluid {
            padding-top: 60px;
            padding-right: 20px;
            padding-left: 20px;
        }

        .form-container {
            border-radius: 10px;
            background-color: #181818;
            color: #fff;
            padding: 20px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
            position: relative;
            margin-right: 20px;
            margin-left: 20px;
        }

        .search-bar input[type="text"],
        .search-bar select {
            border-radius: 30px;
            padding: 10px 20px;
            border: none;
            color: #fff;
        }

        /* Ярлыки для элементов выбора */
        .search-bar label {
            display: block;
            margin-bottom: 5px;
        }

        .search-bar button {
            border-radius: 30px;
            padding: 10px 20px;
            border: none;
            color: #fff;
            background-color: transparent;
        }

        /* Переработанный вид плеера */
        #audioPlayer {
            width: 100%;
            margin-top: 20px;
        }

        .music-list {
            padding: 0;
            margin-right: 20px;
            margin-left: 20px;
        }

        .music-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            border-radius: 5px;
            padding: 10px;
            background-color: #333;
        }

        .music-item img {
            width: 50px;
            height: 50px;
            margin-right: 20px;
            border-radius: 5px;
        }

        .music-item span {
            color: #fff;
        }

        .music-item:hover {
            background-color: transparent;
        }

        .music-item:hover span {
            color: #fff;
        }

        .music-item:hover img {
            border: 2px solid #1db954;
        }

        /* Оформление кнопок и ссылок */
        .theme-toggle,
        .profile-link {
            position: absolute;
            padding: 10px;
            border-radius: 5px;
            color: #fff;
            background-color: transparent;
            border: none;
            text-decoration: none;
        }

        .theme-toggle {
            top: 20px;
            right: 20px;
            font-size: 24px;
        }

        .profile-link {
            top: 20px;
            left: 20px;
            z-index: 10;
        }
        .song-list {
            display: flex;
            gap: 20px;
            overflow-x: auto;
        }

        /* Стили для карточек топ треков */
        .top-tracks-container {
            padding: 40px 0;
            color: #fff;
            background-color: transparent;
            border: 2px solid #fff;
            border-radius: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            max-width: 65%;
            margin: 0 auto;
        }

        .top-tracks-container h2 {
            font-size: 32px;
            font-weight: bold;
        }

        .song-list {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            background-color: transparent;
        }

        .dark-mode .top-tracks-container {
            background-color: #040404;
            color: #b3b3b3;
        }

        .dark-mode .song-list {
            background-color: #121212;
        }

        /* Стили для светлой темы топа треков */
        .light-mode .top-tracks-container {
            background-color: #f5f5f5;
            color: #121212;
        }

        .light-mode .song-list {
            background-color: #ffffff;
        }

        /* Стили для карточек песен */
        .song-list {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            background-color: transparent;
        }

        .song-item img {
            width: 100%;
            height: auto;
            max-width: 100%; /* Добавлено для сохранения пропорций */
            max-height: 200px; /* Установите максимальную высоту */
            object-fit: cover;
        }

        /* Стили для иконки светлой темы */
        .light-mode .theme-toggle::before {
            content: "\f186"; /* Замените код иконки на нужный, это пример кода для иконки day */
            font-family: 'Font Awesome 5 Free',serif;
        }

        /* Стили для иконки темной темы */
        .dark-mode .theme-toggle::before {
            content: "\f186"; /* Замените код иконки на нужный, это пример кода для иконки night */
            font-family: 'Font Awesome 5 Free',serif;
        }

    </style>
    <link href="css/style.css" rel="stylesheet">
</head>
<body>
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <!-- SVG-спрайт с иконками -->
    <symbol id="icon-search" viewBox="0 0 24 24">
        <!-- Иконка лупы для поиска -->
        <path
                d="M19.39 17.97l-4.42-4.42c.74-1.14 1.18-2.48 1.18-3.95C16.15 5.59 12.56 2 8.07 2S0 5.59 0 10.08s4.58 8.08 9.07 8.08c1.47 0 2.81-.44 3.95-1.18l4.42 4.42c.49.49 1.28.49 1.77 0 .49-.49.49-1.28 0-1.77zM2 10.08C2 6.69 5.36 3.33 8.75 3.33S15.5 6.69 15.5 10.08s-3.36 6.75-6.75 6.75S2 13.47 2 10.08z" />
    </symbol>

    <symbol id="headphones-icon" viewBox="0 0 24 24">
        <!-- Иконка наушников в виде гарнитуры -->
        <path d="M3 17V12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12V17M8.28571 21C7.02335 21 6 19.9767 6 18.7143V15.2857C6 14.0233 7.02335 13 8.28571 13C9.23249 13 10 13.7675 10 14.7143V19.2857C10 20.2325 9.23249 21 8.28571 21ZM15.7143 21C16.9767 21 18 19.9767 18 18.7143V15.2857C18 14.0233 16.9767 13 15.7143 13C14.7675 13 14 13.7675 14 14.7143V19.2857C14 20.2325 14.7675 21 15.7143 21Z" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>    </symbol>
</svg>
<div class="container-fluid">
    <a href="profile.html" class="btn btn-primary mb-3 profile-link">Перейти в профиль</a>
    <div class="form-container mt-5">
        <div class="headphones-icon">
            <svg class="icon" width="24" height="24">
                <use xlink:href="#headphones-icon"/>
            </svg>
            <span>Use headphones for better experience</span>
        </div>
        <div class="d-flex align-items-center search-bar">
            <label for="searchInput">Поиск по названию</label>
            <input type="text" id="searchInput" placeholder="Введите текст для поиска" class="form-control mr-2">

            <label for="genreFilter">Выберите жанр</label>
            <select id="genreFilter" class="form-control mr-2">
                <option value="all">Все жанры</option>
                <option value="rock">Рок</option>
                <option value="pop">Поп</option>
                <option value="hiphop">Хип-хоп</option>
                <!-- Другие варианты жанров -->
            </select>
            <button onclick="filterMusic()" class="btn btn-primary">
                <svg class="icon-search">
                    <use xlink:href="#icon-search"></use>
                </svg>
            </button>
        </div>
    </div>
    <ul class="music-list">
        <li class="music-item" onclick="playMusic('music/Imagine_Dragons_-_Natural_57429538.mp3')">
            <img src="image.jpg" alt="Song 1">
            <span>Imagine_Dragons_-_Natural - Rock</span>
        </li>
        <li class="music-item" onclick="playMusic('music/DJ_Snake_Justin_Bieber_-_Let_Me_Love_You_47962926.mp3')">
            <img src="image.jpg" alt="Song 2">
            <span>Justin_Bieber_-_Let_Me_Love_You - Pop</span>
        </li>
        <li class="music-item" onclick="playMusic('music/the_witcher_3_wild_hunt_16 Kaer Morhen.mp3')">
            <img src="image.jpg" alt="Song 1">
            <span>witcher_3_Kaer Morhen - Rock</span>
        </li>
        <!-- Добавьте другие песни -->
    </ul>
    <div id="playlistModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>Выберите плейлист</h3>
            <label for="modalPlaylistSelect"></label><select id="modalPlaylistSelect"></select>
            <button onclick="addToSelectedPlaylist()">Добавить в плейлист</button>
        </div>
    </div>
    <audio id="audioPlayer" controls></audio>
    <div class="theme-toggle" onclick="toggleTheme()">
        <span class="icon-day"></span>
        <span class="icon-night"></span>
    </div>
    <div class="top-tracks-container mt-5">
        <h2 class="text-center mb-4">Топ треков для региона: <span id="userRegion"></span></h2>
        <div class="song-list d-flex flex-wrap justify-content-center"></div>
    </div>
</div>

<!-- jQuery и Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="js/main.js"></script>
<script>
    function fetchTopTracks(region) {
        const apiUrl = `http://localhost:3000/api/top-tracks/${region}`;

        fetch(apiUrl)
            .then(response => response.json())
            .then(tracks => {
                const songList = document.querySelector('.song-list');
                songList.innerHTML = '';

                tracks.forEach(track => {
                    const songItem = document.createElement('div');
                    songItem.classList.add('song-item');

                    const cover = document.createElement('img');
                    cover.src = track.cover;
                    cover.alt = track.title + ' cover';
                    cover.classList.add('song-cover');

                    const songInfo = document.createElement('div');
                    songInfo.classList.add('song-info');

                    const title = document.createElement('h3');
                    title.classList.add('song-title');
                    title.textContent = track.title;

                    const artist = document.createElement('p');
                    artist.classList.add('song-artist');
                    artist.textContent = track.artist;

                    const audio = document.createElement('audio');
                    audio.src = track.audio;
                    audio.controls = true;

                    songInfo.appendChild(title);
                    songInfo.appendChild(artist);

                    songItem.appendChild(cover);
                    songItem.appendChild(songInfo);
                    songItem.appendChild(audio);

                    songList.appendChild(songItem);
                });
            })
            .catch(error => {
                console.error('Error fetching top tracks:', error);
            });

    }

    // Функция для получения региона пользователя
    function getUserRegion() {
        const userLanguage = navigator.language || navigator.userLanguage;
        const countryCode = userLanguage.split('-')[1]; // Получаем код страны из языкового тега

        // Возвращаем код страны или используем 'RU' для России по умолчанию
        return countryCode || 'RU';
    }

    // Определяем регион пользователя и вызываем fetchTopTracks
    const userRegion = getUserRegion();
    fetchTopTracks(userRegion);
    document.getElementById('userRegion').textContent = userRegion;

</script>
</body>
</html>

